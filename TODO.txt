- Clean up the SIGUSR2 code.

- Address all lint warnings.

- Clean up e2e tests.

- Refactor subcommands and add tests.
